<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard Kehadiran Per Kelas</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="main-content">
  <header>
    <h1>üìä Dashboard Kehadiran Bulanan</h1>
    <button class="theme-toggle" id="themeToggle">üåô Dark Mode</button>
  </header>

  <h2 id="dashboardTitle">Ringkasan Absensi</h2>
  
  <div class="filters">
    <label for="monthSelect">Pilih Bulan:</label>
    <select id="monthSelect">
      <option value="">-- Semua Bulan --</option>
      <option value="1">Januari</option>
      <option value="2">Februari</option>
      <option value="3">Maret</option>
      <option value="4">April</option>
      <option value="5">Mei</option>
      <option value="6">Juni</option>
      <option value="7">Juli</option>
      <option value="8">Agustus</option>
      <option value="9">September</option>
      <option value="10">Oktober</option>
      <option value="11">November</option>
      <option value="12">Desember</option>
    </select>
  </div>

  <!-- Pilih Kelas -->
  <section class="filter-section">
    <label for="classSelect">üéì Pilih Kelas:</label>
    <select id="classSelect">
      <option value="">-- Semua Kelas --</option>
      <option value="X-A">X-A</option>
      <option value="X-B">X-B</option>
      <option value="XI-A">XI-A</option>
      <option value="XI-B">XI-B</option>
      <option value="XII-A">XII-A</option>
      <option value="XII-B">XII-B</option>
    </select>
  </section>

  <!-- Summary Cards -->
  <section class="cards">
    <div class="card hadir"><h3>Hadir</h3><p id="hadirCount">0</p></div>
    <div class="card izin"><h3>Izin</h3><p id="izinCount">0</p></div>
    <div class="card sakit"><h3>Sakit</h3><p id="sakitCount">0</p></div>
    <div class="card alfa"><h3>Alfa</h3><p id="alfaCount">0</p></div>
  </section>
  
  <!-- Chart -->
  <section class="chart-container">
    <h2>Grafik Kehadiran Bulanan per Kelas</h2>
    <canvas id="attendanceChart"></canvas>
  </section>

  <section class="chart-container">
    <h2>Persentase Kehadiran per Kelas</h2>
    <div class="pie-wrapper">
      <canvas id="classPieChart"></canvas>
    </div>
  </section>

  <script>
    // Dark Mode Toggle
    function toggleTheme() {
      const currentTheme = document.documentElement.getAttribute('data-theme');
      const newTheme = currentTheme === 'dark' ? '' : 'dark';
      const themeToggle = document.getElementById('themeToggle');
      
      document.documentElement.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme', newTheme);
      
      if (newTheme === 'dark') {
        themeToggle.textContent = '‚òÄÔ∏è Light Mode';
      } else {
        themeToggle.textContent = 'üåô Dark Mode';
      }

      // Update chart theme
      updateChartColors();
    }

    // Load saved theme
    document.addEventListener('DOMContentLoaded', function() {
      const savedTheme = localStorage.getItem('theme');
      const themeToggle = document.getElementById('themeToggle');
      
      if (savedTheme === 'dark') {
        document.documentElement.setAttribute('data-theme', 'dark');
        themeToggle.textContent = '‚òÄÔ∏è Light Mode';
      }

      // Event listener untuk theme toggle
      themeToggle.addEventListener('click', toggleTheme);

      // Initialize charts
      initCharts();

      // Update card values (dummy data)
      updateCardValues();
    });

    // Charts
    let barChart, pieChart;

    function initCharts() {
      const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
      const textColor = isDark ? '#e8f5e9' : '#2d4a2f';
      const gridColor = isDark ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)';

      // Bar Chart
      const ctx = document.getElementById('attendanceChart');
      barChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: ['Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni'],
          datasets: [{
            label: 'Hadir',
            data: [85, 90, 88, 92, 87, 91],
            backgroundColor: 'rgba(126, 201, 130, 0.8)',
            borderColor: 'rgba(126, 201, 130, 1)',
            borderWidth: 2
          }, {
            label: 'Izin',
            data: [8, 5, 7, 4, 6, 5],
            backgroundColor: 'rgba(240, 147, 251, 0.8)',
            borderColor: 'rgba(240, 147, 251, 1)',
            borderWidth: 2
          }, {
            label: 'Sakit',
            data: [5, 4, 3, 3, 5, 3],
            backgroundColor: 'rgba(79, 172, 254, 0.8)',
            borderColor: 'rgba(79, 172, 254, 1)',
            borderWidth: 2
          }, {
            label: 'Alfa',
            data: [2, 1, 2, 1, 2, 1],
            backgroundColor: 'rgba(250, 112, 154, 0.8)',
            borderColor: 'rgba(250, 112, 154, 1)',
            borderWidth: 2
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: true,
          plugins: {
            legend: {
              position: 'top',
              labels: {
                color: textColor,
                font: {
                  family: 'Inter',
                  size: 12,
                  weight: '600'
                },
                padding: 15
              }
            },
            tooltip: {
              backgroundColor: 'rgba(0, 0, 0, 0.8)',
              padding: 12,
              titleFont: {
                size: 14,
                weight: 'bold'
              },
              bodyFont: {
                size: 13
              },
              cornerRadius: 8
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                color: textColor,
                font: {
                  size: 11
                }
              },
              grid: {
                color: gridColor,
                drawBorder: false
              }
            },
            x: {
              ticks: {
                color: textColor,
                font: {
                  size: 11
                }
              },
              grid: {
                color: gridColor,
                drawBorder: false
              }
            }
          }
        }
      });

      // Pie Chart
      const pieCtx = document.getElementById('classPieChart');
      pieChart = new Chart(pieCtx, {
        type: 'pie',
        data: {
          labels: ['Kelas X-A', 'Kelas X-B', 'Kelas XI-A', 'Kelas XI-B'],
          datasets: [{
            data: [92, 88, 90, 85],
            backgroundColor: [
              'rgba(126, 201, 130, 0.8)',
              'rgba(79, 172, 254, 0.8)',
              'rgba(240, 147, 251, 0.8)',
              'rgba(250, 112, 154, 0.8)'
            ],
            borderColor: [
              'rgba(126, 201, 130, 1)',
              'rgba(79, 172, 254, 1)',
              'rgba(240, 147, 251, 1)',
              'rgba(250, 112, 154, 1)'
            ],
            borderWidth: 2
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: true,
          plugins: {
            legend: {
              position: 'bottom',
              labels: {
                color: textColor,
                font: {
                  family: 'Inter',
                  size: 12,
                  weight: '600'
                },
                padding: 15,
                boxWidth: 15,
                boxHeight: 15
              }
            },
            tooltip: {
              backgroundColor: 'rgba(0, 0, 0, 0.8)',
              padding: 12,
              titleFont: {
                size: 14,
                weight: 'bold'
              },
              bodyFont: {
                size: 13
              },
              cornerRadius: 8,
              callbacks: {
                label: function(context) {
                  let label = context.label || '';
                  if (label) {
                    label += ': ';
                  }
                  label += context.parsed + '%';
                  return label;
                }
              }
            }
          }
        }
      });
    }

    function updateChartColors() {
      if (!barChart || !pieChart) return;

      const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
      const textColor = isDark ? '#e8f5e9' : '#2d4a2f';
      const gridColor = isDark ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)';

      // Update bar chart
      barChart.options.plugins.legend.labels.color = textColor;
      barChart.options.scales.y.ticks.color = textColor;
      barChart.options.scales.x.ticks.color = textColor;
      barChart.options.scales.y.grid.color = gridColor;
      barChart.options.scales.x.grid.color = gridColor;
      barChart.update();

      // Update pie chart
      pieChart.options.plugins.legend.labels.color = textColor;
      pieChart.update();
    }

    function updateCardValues() {
      // Dummy data - ganti dengan data asli dari API/CSV
      document.getElementById('hadirCount').textContent = '458';
      document.getElementById('izinCount').textContent = '35';
      document.getElementById('sakitCount').textContent = '23';
      document.getElementById('alfaCount').textContent = '9';
    }

    // Filter handlers
    document.getElementById('monthSelect').addEventListener('change', function() {
      const selectedMonth = this.value;
      console.log('Filter bulan:', selectedMonth || 'Semua');
      // Tambahkan logic filter data berdasarkan bulan
    });

    document.getElementById('classSelect').addEventListener('change', function() {
      const selectedClass = this.value;
      console.log('Filter kelas:', selectedClass || 'Semua');
      // Tambahkan logic filter data berdasarkan kelas
    });
  </script>
</body>
</html>
